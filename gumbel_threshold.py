# -*- coding: utf-8 -*-
"""
Created on Wed Apr 02 10:44:32 2014

@author: rarossi
"""

data = [189.9, 190.2, 190.0, 189.1, 191.7, 189.0, 189.6, 192.1, 189.8, 188.5, 193.9, 191.8,
        193.1, 187.1, 192.6, 189.8, 188.4, 187.8, 188.1, 189.9, 193.2, 191.8, 190.8, 190.0,
        192.5, 187.4, 191.9, 190.4, 191.4, 191.8, 189.2, 191.3, 189.1, 190.2, 194.2, 188.5,
        190.6, 189.1, 190.9, 193.9, 188.2, 191.0, 187.7, 192.2, 190.2, 190.0, 191.0, 192.7,
        189.0, 190.3, 190.4, 192.3, 192.5, 195.2, 188.8, 188.9, 190.0, 188.9, 191.2, 189.3,
        190.9, 191.1, 188.6, 189.4, 187.8, 190.3, 189.4, 189.2, 192.8, 190.9, 192.8, 191.9,
        192.1, 189.9, 189.4, 190.3, 188.5, 200.8, 191.0, 189.9, 189.1, 188.3, 192.8, 191.4,
        191.5, 191.7, 191.6, 189.7, 190.8, 188.4, 198.0, 189.9, 190.3, 193.0, 188.9, 191.3,
        188.0, 191.9, 191.6, 189.2, 189.7, 191.6, 190.6, 190.4, 187.8, 193.6, 186.9, 190.6,
        189.0, 189.8, 189.3, 187.8, 193.3, 189.6, 192.4, 190.3, 189.3, 191.5, 192.4, 189.1,
        190.1, 188.8, 191.7, 190.2, 189.1, 190.7, 191.4, 188.6, 192.2, 190.7, 191.2, 188.1,
        189.2, 187.3, 192.3, 188.8, 191.1, 192.4, 190.3, 192.0, 187.2, 189.3, 189.4, 192.3,
        192.4, 188.3, 187.8, 192.4, 188.3, 192.0, 189.7, 196.6, 193.1, 187.1, 191.0, 187.7,
        192.5, 189.4, 191.4, 193.0, 189.7, 188.0, 190.9, 189.1, 190.8, 190.4, 188.3, 191.4,
        189.5, 191.0, 188.4, 190.3, 195.6, 192.1, 191.4, 191.5, 190.2, 188.2, 197.4, 189.5,
        190.2, 191.1, 188.7, 188.9, 190.6, 192.0, 192.2, 189.5, 189.9, 193.2, 191.2, 190.9,
        188.0, 189.4, 190.2, 194.0, 187.5, 189.0, 189.0, 191.2, 190.2, 192.4, 189.8, 191.4,
        191.3, 188.1, 191.4, 189.2, 193.0, 193.1, 191.2, 189.1, 187.9, 189.7, 189.1, 189.7,
        190.8, 188.8, 187.9, 189.8, 190.5, 191.4, 194.4, 191.4, 192.4, 190.3, 189.0, 192.0,
        189.3, 195.7, 190.3, 190.6, 188.6, 189.9, 189.9, 192.6, 190.9, 188.3, 189.1, 188.5,
        188.6, 188.1, 189.3, 189.5, 190.1, 195.2, 187.8, 190.6, 189.6, 191.2, 189.8, 192.3,
        190.9, 193.6, 188.6, 188.3, 189.4, 188.8, 189.9, 191.7, 191.7, 188.9, 192.0, 192.8,
        190.6, 190.2, 191.9, 189.2, 189.1, 190.0, 191.1, 190.0, 189.7, 204.8, 192.7, 190.3,
        189.3, 192.6, 189.3, 192.1, 195.8, 190.2, 193.8, 190.4, 190.3, 189.3, 191.7, 190.3,
        189.4, 190.9, 198.7, 191.3, 188.9, 191.6, 191.7, 192.2, 190.5, 191.4, 189.7, 191.1,
        190.0, 190.5, 190.3, 188.8, 188.4, 189.4, 190.8, 188.0, 199.0, 196.1, 191.1, 190.5,
        191.6, 190.3, 190.8, 191.2, 192.7, 189.6, 190.6, 190.0, 196.7, 190.4, 191.8, 190.3,
        189.8, 190.9, 191.0, 189.4, 191.5, 190.2, 190.4, 188.7, 190.8, 189.3, 190.3, 190.8,
        189.9, 189.2, 189.8, 190.7, 190.5, 188.8, 191.1, 189.4, 189.7, 188.3, 188.9, 190.1,
        190.0, 189.2, 188.8, 190.1, 192.6, 188.6, 191.7, 189.8, 192.3, 191.4, 190.7, 188.4,
        189.4, 191.1, 188.4, 189.1, 189.8, 188.6, 191.4, 190.1, 191.7, 189.5, 189.3, 190.1,
        191.7, 191.7, 189.5, 188.7, 191.1, 190.9, 191.0, 194.1, 191.0, 192.6, 189.1, 192.5,
        192.7, 191.7, 190.2, 189.9, 191.6, 191.0, 194.5, 188.8, 191.5, 194.6, 188.5, 189.2,
        190.0, 191.4, 188.5, 191.4, 190.2, 189.3, 194.9, 194.7, 189.3, 189.2, 191.2, 192.3,
        190.5, 191.0, 192.5, 189.9, 194.6, 199.7, 195.3, 188.9, 192.7, 193.5, 189.2, 190.2,
        211.9, 190.3, 191.8, 190.1, 188.7, 191.3, 192.0, 191.3, 188.5, 192.0, 190.5, 192.7,
        191.7, 190.9, 191.6, 188.8, 190.4, 191.6, 190.6, 189.1, 190.5, 189.6, 191.7, 191.3,
        190.5, 191.1, 196.3, 189.9, 189.5, 195.4, 189.1, 194.3, 192.2, 189.3, 188.6, 188.9,
        192.2, 189.0, 189.3, 191.2, 191.3, 188.4, 190.2, 189.3, 191.7, 189.4, 190.5, 188.4,
        188.2, 188.1, 191.1, 195.6, 189.8, 190.4, 188.7, 187.6, 190.3, 192.1, 190.4, 191.8,
        192.7, 187.9, 189.9, 190.1, 190.9, 187.5, 190.1, 188.7, 190.4, 187.8, 190.1, 191.8,
        188.8, 191.0, 200.0, 190.2, 192.2, 190.0, 196.4, 188.4, 190.7, 189.2, 188.8, 188.8,
        190.5, 189.3, 192.6, 188.0, 191.4, 192.6, 188.8, 189.2, 188.5, 193.7, 191.4, 191.5,
        192.2, 187.8, 198.5, 197.8, 190.2, 188.7, 190.8, 192.7, 189.2, 190.0, 189.6, 193.2,
        190.0, 191.3, 190.8, 193.4, 189.2, 193.1, 188.5, 197.0, 195.2, 191.8, 191.6, 188.5,
        191.1, 189.3, 189.7, 188.1, 190.7, 192.6, 189.8, 188.5, 188.0, 192.0, 191.0, 190.6,
        191.3, 191.4, 189.7, 189.3, 190.7, 192.1, 188.6, 189.1, 189.3, 189.8, 190.3, 188.0,
        192.4, 190.1, 190.3, 190.4, 187.8, 191.5, 191.8, 192.5, 191.1, 189.5, 189.8, 189.0,
        189.9, 189.1, 191.4, 194.1, 189.2, 188.9, 188.3, 191.0, 190.9, 187.8, 192.2, 191.0,
        191.9, 187.8, 189.9, 188.1, 190.0, 188.0, 190.7, 189.6, 192.1, 189.6, 203.7, 190.2,
        190.8, 190.3, 187.8, 189.8, 189.5, 188.4, 193.4, 190.5, 190.2, 193.4, 194.6, 188.4,
        188.0, 191.2, 188.5, 189.6, 192.9, 188.4, 187.8, 188.2, 200.2, 190.2, 190.6, 188.3,
        189.4, 189.5, 188.9, 191.2, 190.1, 191.5, 190.9, 188.3, 188.4, 189.2, 189.6, 192.3,
        191.8, 216.6, 189.2, 189.9, 196.1, 189.5, 188.9, 192.1, 188.1, 188.7, 189.6, 188.9,
        190.8, 191.6, 191.5, 190.8, 189.0, 190.0, 189.8, 190.4, 189.0, 191.2, 193.5, 189.2,
        189.7, 189.1, 190.4, 192.2, 190.8, 192.7, 191.3, 189.4, 192.2, 189.4, 193.7, 188.8,
        192.6, 191.4, 190.5, 190.4, 187.7, 191.2, 194.0, 190.8, 189.9, 189.3, 189.1, 189.6,
        189.8, 188.7, 190.9, 191.8, 189.5, 191.6, 190.8, 192.7, 191.5, 188.0, 191.1, 190.9,
        189.2, 188.0, 189.2, 196.5, 189.9, 187.4, 189.2, 190.0, 191.7, 189.6, 187.9, 190.2,
        190.4, 191.9, 190.1, 190.4, 191.2, 191.3, 194.5, 190.0, 190.2, 189.5, 189.0, 190.7,
        189.4, 192.8, 190.2, 188.8, 189.8, 188.7, 190.1, 188.3, 189.9, 190.9, 189.2, 190.6,
        189.7, 190.1, 193.3, 190.6, 191.6, 190.6, 190.0, 190.3, 190.3, 192.2, 193.9, 192.7,
        190.1, 187.8, 189.4, 189.8, 188.4, 190.0, 189.4, 190.2, 191.4, 190.8, 189.0, 190.1,
        191.0, 188.2, 192.1, 189.4, 189.8, 191.7, 191.4, 189.2, 188.8, 191.8, 191.6, 196.3,
        189.6, 189.5, 189.8, 191.2, 189.6, 189.5, 191.0, 188.9, 190.5, 190.0, 197.8, 191.2,
        190.2, 188.5, 189.9, 190.1, 189.0, 190.3, 190.2, 189.4, 190.4, 189.5, 192.3, 192.1,
        191.4, 192.5, 190.5, 190.7, 189.7, 189.8, 193.4, 190.4, 189.1, 191.3, 191.9, 189.4,
        188.5, 188.2, 189.9, 189.8, 189.1, 189.5, 193.4, 191.1, 191.2, 189.5, 189.4, 194.7,
        190.6, 188.6, 190.7, 191.9, 190.4, 189.6, 192.1, 191.2, 189.8, 189.3, 191.0, 189.6,
        191.3, 188.8, 193.9, 190.6, 190.6, 190.5, 189.8, 192.3, 189.5, 189.6, 191.0, 188.8,
        191.1, 190.1, 189.3, 190.6, 189.4, 190.5, 189.6, 188.8, 190.2, 190.1, 188.6, 191.0,
        191.0, 192.4, 188.1, 189.8, 189.7, 191.0, 189.3, 188.9, 194.7, 187.9, 189.9, 191.2,
        190.3, 192.1, 191.2, 189.8, 191.4, 192.2, 190.4, 188.8, 192.6, 191.0, 188.5, 190.8,
        187.0, 190.8, 192.0, 190.7, 186.9, 188.7, 191.7, 190.9, 191.2, 191.3, 190.3, 188.9,
        190.6, 191.0, 191.4, 188.7, 190.6, 189.9, 192.4, 189.6, 199.6, 193.6, 209.5, 191.7,
        189.9, 189.5, 190.9, 189.6, 189.6, 198.0, 192.2, 189.7, 188.9, 188.8, 189.9, 189.3,
        189.9, 191.0, 194.6, 190.1, 190.7, 187.7, 189.0, 190.3, 189.4, 190.2, 190.6, 192.1,
        190.5, 186.6, 190.8, 192.1, 191.0, 189.9, 189.5, 189.2, 191.1, 189.9, 190.3, 190.2,
        191.3, 188.2, 190.5, 189.3, 188.9, 188.7, 189.4, 191.3, 190.9, 189.9, 189.0, 191.0,
        190.1, 191.3, 190.1, 189.2, 189.3, 189.8, 187.6, 189.9, 191.4, 189.5, 192.0, 188.5,
        188.8, 188.9, 190.7, 189.3, 190.0, 192.4, 190.5, 189.7, 190.9, 191.2, 189.4, 190.6,
        189.5, 192.0, 187.9, 189.6, 190.9, 193.0, 190.0, 191.6, 190.9, 188.5, 189.4, 189.5,
        188.5, 189.7, 188.2, 190.8, 186.9, 189.3, 189.8, 188.6, 191.4, 190.9, 188.8, 191.9,
        188.2, 191.7, 205.6, 204.6]

from scipy import stats
confidence=0.9999
loc,scale = stats.gumbel_r.fit(data)
g=stats.gumbel_r(loc=loc,scale=scale)
print "Using all data %.2f" % g.ppf(confidence)
threshold = 192.0
fdata = [x for x in data if x>=threshold]
loc,scale = stats.gumbel_r.fit(fdata)
fg=stats.gumbel_r(loc=loc,scale=scale)
print "Using threshold %.2f" % fg.ppf(confidence)
plt.hist(data, 30, normed=1)
plt.hist(fdata, 30, normed=1)
print """
    Note that after threshold the histogram becomes not valid for
    a Gumbel distribution.
    So applying a threshold is not a good idea in this case.
"""